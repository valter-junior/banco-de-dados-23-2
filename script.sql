
/*

CRIANDO TABELAS

*/

-- Livro
CREATE TABLE LIVRO (
   ISBN VARCHAR(13) NOT NULL,
   TITULO VARCHAR(100),
   CONSTRAINT PK_ISBN PRIMARY KEY (ISBN)
);

-- Gênero
CREATE TABLE GENERO (
   ISBN VARCHAR(13),
   GENERO VARCHAR(50),
   CONSTRAINT PK_GENERO PRIMARY KEY (ISBN, GENERO),
   CONSTRAINT FK_GENEROLIVRO FOREIGN KEY (ISBN) REFERENCES LIVRO (ISBN) ON DELETE CASCADE
   );

--Grupo
CREATE TABLE GRUPO (
    COD VARCHAR(4),
    CNPJ VARCHAR(14),
    CONSTRAINT PK_GRUPO PRIMARY KEY (COD)
);

--Livraria
CREATE TABLE LIVRARIA (
    COD VARCHAR(4),
    NUM VARCHAR(20),
    NOME VARCHAR(100),
    END_CEP VARCHAR(8),
    END_BAIRRO VARCHAR(100),
    END_RUA VARCHAR(100),
    END_NUM VARCHAR(10),
    CONSTRAINT PK_LIVRARIA PRIMARY KEY (COD, NUM),
    CONSTRAINT FK_CODGRUPO FOREIGN KEY (COD) REFERENCES GRUPO(COD) ON DELETE CASCADE
);


-- Funcionário
CREATE TABLE FUNCIONARIO (
   CPF VARCHAR(11),
   NOME VARCHAR(100),
   CPF_CHEFE VARCHAR(11),
   NUM_LIVRARIA VARCHAR(20),
   COD_LIVRARIA VARCHAR(4),
   CONSTRAINT PK_FUNCIONARIO PRIMARY KEY (CPF),
   CONSTRAINT FK_CPF_CHEFE FOREIGN KEY (CPF_CHEFE) REFERENCES FUNCIONARIO (CPF),
   CONSTRAINT FK_CODNUMLIVRARIA FOREIGN KEY (NUM_LIVRARIA, COD_LIVRARIA) REFERENCES LIVRARIA(NUM, COD)
);

--Cliente 
CREATE TABLE CLIENTE (
    ID_CLIENTE VARCHAR(10),
    END_CEP VARCHAR(8),
    END_RUA VARCHAR(100),
    CONSTRAINT PK_CLIENTE PRIMARY KEY (ID_CLIENTE)
);

-- Emails-Cliente
CREATE TABLE EMAIL (
    ID_CLIENTE VARCHAR(10),
    EMAIL VARCHAR(100),
    CONSTRAINT FK_CLIENTE FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE),
    CONSTRAINT PK_EMAILCLIENTE PRIMARY KEY (ID_CLIENTE, EMAIL)
);

-- Cartão 
CREATE TABLE CARTAO (
    NUM VARCHAR(16),
    ID_CLIENTE VARCHAR(10),
    CONSTRAINT FK_CLIENTECARTAO FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE (ID_CLIENTE),
    CONSTRAINT PK_CARTAO PRIMARY KEY (NUM, ID_CLIENTE)
    
);

--Desconto 
CREATE TABLE DESCONTO (
    COD_DESC VARCHAR(6),
    VALOR INT CHECK (valor >= 0 AND valor <= 100),
    CONSTRAINT PK_DESCONTO PRIMARY KEY (COD_DESC)
);

-- Autor
CREATE TABLE AUTOR (
    MAT VARCHAR(10),
    NOME VARCHAR(100),
    NACIONALIDADE VARCHAR(40),
    CONSTRAINT PK_AUTOR PRIMARY KEY (MAT)
);

-- Cliente PJ
CREATE TABLE PESSOAJURIDICA (
    ID_CLIENTE VARCHAR(10),
    CNPJ VARCHAR(20),
    RAZAO_SOCIAL VARCHAR(100),
    CONSTRAINT PK_CLIENTE_PJ PRIMARY KEY (ID_CLIENTE),
    CONSTRAINT FK_CLIENTEPJID FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE)
);

-- Cliente PF
CREATE TABLE PESSOAFISICA (
    ID_CLIENTE VARCHAR(10),
    CPF VARCHAR(14),
    NOME VARCHAR(100),
    DATA_NASCIMENTO DATE,
    CONSTRAINT PK_CLIENTEPF PRIMARY KEY (ID_CLIENTE),
    CONSTRAINT FK_CLIENTEPFID FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE)
);

-- Compra
CREATE TABLE COMPRA (
    ID_CLIENTE VARCHAR(10) NOT NULL,
    CPF_FUNC VARCHAR(11) NOT NULL,
    ISBN VARCHAR(13) NOT NULL,
    DATA_COMPRA DATE NOT NULL,
    COD_DESC VARCHAR(6),
    CONSTRAINT FK_IDCLIENTE FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE),
    CONSTRAINT FK_CPFFUNC FOREIGN KEY (CPF_FUNC) REFERENCES FUNCIONARIO(CPF),
    CONSTRAINT FK_LIVROISBN FOREIGN KEY (ISBN) REFERENCES LIVRO(ISBN),
    CONSTRAINT FK_CODDESC FOREIGN KEY (COD_DESC) REFERENCES DESCONTO(COD_DESC),
    CONSTRAINT PK_COMPRA PRIMARY KEY (ID_CLIENTE, CPF_FUNC, ISBN, DATA_COMPRA)
);

-- Escreve
CREATE TABLE ESCREVE (
ISBN VARCHAR(13),
MAT VARCHAR(10),
CONSTRAINT PK_ESCREVE PRIMARY KEY (ISBN, MAT),
CONSTRAINT FK_ISBNLIVRO FOREIGN KEY (ISBN) REFERENCES LIVRO(ISBN) ON DELETE CASCADE,
CONSTRAINT FK_MATAUTOR FOREIGN KEY (MAT) REFERENCES AUTOR(MAT) ON DELETE CASCADE
);




/*

POVOANDO AS TABELAS

*/


-- ///////////////////////////// Inserir dados na tabela GRUPO /////////////////////////////

-- Grupos com livrarias
INSERT INTO GRUPO (COD, CNPJ) VALUES ('G001', '12345678901234');
INSERT INTO GRUPO (COD, CNPJ) VALUES ('G002', '98765432109876');
-- Grupo sem livrarias
INSERT INTO GRUPO (COD, CNPJ) VALUES ('G003', '00000032109876');



-- ///////////////////////////// Inserir dados na tabela LIVRARIA /////////////////////////////

--Livraria do grupo G001
INSERT INTO LIVRARIA (COD, NUM, NOME, END_CEP, END_BAIRRO, END_RUA, END_NUM) VALUES ('G001', 'L1G1', 'Livraria Legal do Grupo 1', '12345678', 'Boa Viagem', 'Rua José Paraíso', '182');
--Livraria do grupo G002
INSERT INTO LIVRARIA (COD, NUM, NOME, END_CEP, END_BAIRRO, END_RUA, END_NUM) VALUES ('G002', 'L1G2', 'Livraria Bacana do Grupo 2', '98765432', 'Imbiribeira', 'Rua Secundária', '456');



-- ///////////////////////////// Inserir dados na tabela FUNCIONARIO /////////////////////////////

--- Na livraria L1G1
-- Chefe
INSERT INTO FUNCIONARIO (CPF, NOME, CPF_CHEFE, NUM_LIVRARIA, COD_LIVRARIA) VALUES ('00000000000', 'Bruna Cristina', NULL, 'L1G1', 'G001');
--Subordinado
INSERT INTO FUNCIONARIO (CPF, NOME, CPF_CHEFE, NUM_LIVRARIA, COD_LIVRARIA) VALUES ('11111111111', 'João Silva', '00000000000', 'L1G1', 'G001');

-- Na livraria L2G2
-- Chefe
INSERT INTO FUNCIONARIO (CPF, NOME, CPF_CHEFE, NUM_LIVRARIA, COD_LIVRARIA) VALUES ('22222222222', 'Carlos Tenório', NULL, 'L1G2', 'G002');
-- Subordinado
INSERT INTO FUNCIONARIO (CPF, NOME, CPF_CHEFE, NUM_LIVRARIA, COD_LIVRARIA) VALUES ('33333333333', 'Maria Santos', '22222222222', 'L1G2', 'G002');



-- ///////////////////////////// Inserir dados na tabela CLIENTE (Clientes, Clientes PF, CLiente PJ e E-mails) /////////////////////////////

-- Clientes PJ e PF
INSERT INTO CLIENTE (ID_CLIENTE, END_CEP, END_RUA) VALUES ('PF00000000', '12345678', 'Rua da Árvore');
INSERT INTO CLIENTE (ID_CLIENTE, END_CEP, END_RUA) VALUES ('PF00000001', '87654321', 'Travessa Camilo Dias');
INSERT INTO CLIENTE (ID_CLIENTE, END_CEP, END_RUA) VALUES ('PJ00000000', '01201221', 'Rua Bonita');
INSERT INTO CLIENTE (ID_CLIENTE, END_CEP, END_RUA) VALUES ('PJ00000001', '12312302', 'Rua Nova');

-- Clientes PF
INSERT INTO PESSOAFISICA (ID_CLIENTE, CPF, NOME, DATA_NASCIMENTO) VALUES ('PF00000000', '11100011100', 'Fernanda Pascoal', TO_DATE('28/12/1995','DD/MM/YYYY'));
INSERT INTO PESSOAFISICA (ID_CLIENTE, CPF, NOME, DATA_NASCIMENTO) VALUES ('PF00000001', '22200022200', 'Marcos Braga', TO_DATE('12/03/1970','DD/MM/YYYY'));

-- Clientes PJ
INSERT INTO PESSOAJURIDICA (ID_CLIENTE, CNPJ, RAZAO_SOCIAL) VALUES ('PJ00000000', '18718328621138543954', 'Sebo do Betinho');
INSERT INTO PESSOAJURIDICA (ID_CLIENTE, CNPJ, RAZAO_SOCIAL) VALUES ('PJ00000001', '35049348348491040392', 'Escola Evoluçao');

-- Email
INSERT INTO EMAIL (ID_CLIENTE, EMAIL) VALUES ('PF00000000', 'fernandap@gmail.com');
INSERT INTO EMAIL (ID_CLIENTE, EMAIL) VALUES ('PF00000000', 'falp@gmail.com');
INSERT INTO EMAIL (ID_CLIENTE, EMAIL) VALUES ('PF00000001', 'marcosb@gmail.com');
INSERT INTO EMAIL (ID_CLIENTE, EMAIL) VALUES ('PJ00000000', 'sebodobetinho@gmail.com');
INSERT INTO EMAIL (ID_CLIENTE, EMAIL) VALUES ('PJ00000001', 'escolaevolucao@gmail.com');
INSERT INTO EMAIL (ID_CLIENTE, EMAIL) VALUES ('PJ00000001', 'escolaevolucao@hotmail.com');
INSERT INTO EMAIL (ID_CLIENTE, EMAIL) VALUES ('PJ00000001', 'escolaevolucao@escolaevolucao.com');



-- ///////////////////////////// Inserir dados na tabela CARTAO /////////////////////////////

INSERT INTO CARTAO (NUM, ID_CLIENTE)  VALUES ('1111222233334444', 'PF00000000');
INSERT INTO CARTAO (NUM, ID_CLIENTE)  VALUES ('0000111100001111', 'PF00000000');
INSERT INTO CARTAO (NUM, ID_CLIENTE)  VALUES ('9999888877776666', 'PJ00000001');
INSERT INTO CARTAO (NUM, ID_CLIENTE)  VALUES ('1212232334344545', 'PJ00000001');
INSERT INTO CARTAO (NUM, ID_CLIENTE)  VALUES ('0011002200330044', 'PJ00000001');



-- ///////////////////////////// Inserir dados na tabela DESCONTO /////////////////////////////

INSERT INTO DESCONTO (COD_DESC, VALOR) VALUES ('DESC00', 10);
INSERT INTO DESCONTO (COD_DESC, VALOR) VALUES ('DESC01', 15);
INSERT INTO DESCONTO (COD_DESC, VALOR) VALUES ('DESC02', 20);
INSERT INTO DESCONTO (COD_DESC, VALOR) VALUES ('DESC03', 25);
INSERT INTO DESCONTO (COD_DESC, VALOR) VALUES ('DESC04', 30);
INSERT INTO DESCONTO (COD_DESC, VALOR) VALUES ('DESC05', 35);
INSERT INTO DESCONTO (COD_DESC, VALOR) VALUES ('DESC06', 50);



-- ///////////////////////////// Inserir dados na tabela AUTOR /////////////////////////////





/*

-- Inserir dados na tabela AUTOR
INSERT INTO AUTOR (MAT, NOME, NACIONALIDADE)
VALUES ('A001', 'Carlos Drummond de Andrade', 'Brasileira'),
       ('A002', 'Gabriel García Márquez', 'Colombiana');

-- Inserir dados na tabela LIVRO
INSERT INTO LIVRO (ISBN, TITULO)
VALUES ('9781234567890', 'Grande Sertão: Veredas'),
       ('9789876543210', 'Cem Anos de Solidão');

-- Inserir dados na tabela PESSOAJURIDICA
INSERT INTO PESSOAJURIDICA (ID_CLIENTE, CNPJ, RAZAO_SOCIAL)
VALUES ('CL001', '12345678901234', 'Empresa ABC'),
       ('CL002', '98765432109876', 'Empresa XYZ');

-- Inserir dados na tabela PESSOAFISICA
INSERT INTO PESSOAFISICA (ID_CLIENTE, CPF, NOME, DATA)
VALUES ('CL003', '33333333333', 'Ana Silva', '1990-05-15'),
       ('CL004', '44444444444', 'Pedro Santos', '1985-09-20');

-- Inserir dados na tabela COMPRA
INSERT INTO COMPRA (ID_CLIENTE, CPF_FUNC, ISBN, DATA_COMPRA, COD_DESC)
VALUES ('CL001', '11111111111', '9781234567890', '2024-03-01', 'D001'),
       ('CL002', '22222222222', '9789876543210', '2024-03-05', 'D002');

-- Inserir dados na tabela ESCREVE
INSERT INTO ESCREVE (ISBN, MAT)
VALUES ('9781234567890', 'A001'),
       ('9789876543210', 'A002');

*/



